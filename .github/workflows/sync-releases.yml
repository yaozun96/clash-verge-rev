name: Sync Upstream Releases (debug mode)

on:
  workflow_dispatch:

permissions:
  contents: write

jobs:
  sync_releases:
    runs-on: ubuntu-latest
    steps:
      - name: å¯ç”¨è°ƒè¯•è¾“å‡º
        run: |
          set -x
          echo "å¯åŠ¨è°ƒè¯•æ¨¡å¼"

      - name: å®‰è£…ä¾èµ–
        run: |
          sudo apt-get update
          sudo apt-get install -y jq gh curl

      - name: ç™»å½• GitHub CLIï¼ˆè°ƒè¯•ï¼‰
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        run: |
          echo "ä½¿ç”¨ GITHUB_TOKEN ç™»å½•..."
          echo "${GITHUB_TOKEN}" | gh auth login --with-token --hostname github.com || echo "âŒ ç™»å½•å¤±è´¥"
          gh auth status || echo "âš ï¸ æ— æ³•éªŒè¯ç™»å½•çŠ¶æ€"

      - name: æµ‹è¯• gh å‘½ä»¤æ˜¯å¦å¯ç”¨
        run: |
          gh --version
          gh repo view clash-verge-rev/clash-verge-rev || echo "âš ï¸ æ— æ³•è®¿é—®ä¸Šæ¸¸ä»“åº“"

      - name: å°è¯•åˆ—å‡ºä¸Šæ¸¸ releasesï¼ˆæµ‹è¯•ï¼‰
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        run: |
          echo "ğŸ§© å°è¯•åˆ—å‡ºä¸Šæ¸¸ releases..."
          gh release list -R clash-verge-rev/clash-verge-rev --limit 5 || echo "âŒ è·å–å¤±è´¥"

      - name: è¾“å‡ºç»“è®º
        run: echo "âœ… è°ƒè¯•æ­¥éª¤æ‰§è¡Œå®Œæ¯•ã€‚æŸ¥çœ‹ä¸Šæ–¹è¾“å‡ºä¿¡æ¯ç¡®å®šå“ªä¸€æ­¥å¤±è´¥ã€‚"
